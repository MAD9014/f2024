<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>9.2 Asynchronous Code | MAD9014</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="Cross-Platform Web Development">
    
    <link rel="preload" href="/f2024/assets/css/0.styles.0983e6c5.css" as="style"><link rel="preload" href="/f2024/assets/js/app.1fe26343.js" as="script"><link rel="preload" href="/f2024/assets/js/2.309c8f6c.js" as="script"><link rel="preload" href="/f2024/assets/js/36.da367d38.js" as="script"><link rel="preload" href="/f2024/assets/js/4.1db6dd32.js" as="script"><link rel="preload" href="/f2024/assets/js/6.42129677.js" as="script"><link rel="prefetch" href="/f2024/assets/js/10.44e74f42.js"><link rel="prefetch" href="/f2024/assets/js/11.13d86ffd.js"><link rel="prefetch" href="/f2024/assets/js/12.3fb6dd52.js"><link rel="prefetch" href="/f2024/assets/js/13.28acfa0e.js"><link rel="prefetch" href="/f2024/assets/js/14.c4c8460d.js"><link rel="prefetch" href="/f2024/assets/js/15.232dbc96.js"><link rel="prefetch" href="/f2024/assets/js/16.4b012593.js"><link rel="prefetch" href="/f2024/assets/js/17.8a9f3b67.js"><link rel="prefetch" href="/f2024/assets/js/18.5cd65609.js"><link rel="prefetch" href="/f2024/assets/js/19.0f604b11.js"><link rel="prefetch" href="/f2024/assets/js/20.72adfa2c.js"><link rel="prefetch" href="/f2024/assets/js/21.5be20940.js"><link rel="prefetch" href="/f2024/assets/js/22.19cc8e02.js"><link rel="prefetch" href="/f2024/assets/js/23.31ebc8b9.js"><link rel="prefetch" href="/f2024/assets/js/24.00b755ec.js"><link rel="prefetch" href="/f2024/assets/js/25.a6bda48d.js"><link rel="prefetch" href="/f2024/assets/js/26.0af317fa.js"><link rel="prefetch" href="/f2024/assets/js/27.c417d3c2.js"><link rel="prefetch" href="/f2024/assets/js/28.69283b6d.js"><link rel="prefetch" href="/f2024/assets/js/29.2ec39f4b.js"><link rel="prefetch" href="/f2024/assets/js/3.0ff4921b.js"><link rel="prefetch" href="/f2024/assets/js/30.2fec257d.js"><link rel="prefetch" href="/f2024/assets/js/31.8ba062aa.js"><link rel="prefetch" href="/f2024/assets/js/32.7030e1ea.js"><link rel="prefetch" href="/f2024/assets/js/33.0b7f6c06.js"><link rel="prefetch" href="/f2024/assets/js/34.ac3859db.js"><link rel="prefetch" href="/f2024/assets/js/35.2050ddde.js"><link rel="prefetch" href="/f2024/assets/js/37.b5c49771.js"><link rel="prefetch" href="/f2024/assets/js/38.dbafaa22.js"><link rel="prefetch" href="/f2024/assets/js/39.c8f62f4e.js"><link rel="prefetch" href="/f2024/assets/js/40.a06e1bdb.js"><link rel="prefetch" href="/f2024/assets/js/41.07f427cf.js"><link rel="prefetch" href="/f2024/assets/js/42.675dfc16.js"><link rel="prefetch" href="/f2024/assets/js/43.75d3d889.js"><link rel="prefetch" href="/f2024/assets/js/44.c3e62b4c.js"><link rel="prefetch" href="/f2024/assets/js/45.8e7fad2c.js"><link rel="prefetch" href="/f2024/assets/js/46.dd175986.js"><link rel="prefetch" href="/f2024/assets/js/47.fe770d77.js"><link rel="prefetch" href="/f2024/assets/js/48.fc338352.js"><link rel="prefetch" href="/f2024/assets/js/49.6f65c285.js"><link rel="prefetch" href="/f2024/assets/js/5.add29278.js"><link rel="prefetch" href="/f2024/assets/js/7.5e49a92f.js"><link rel="prefetch" href="/f2024/assets/js/8.3f0a9cd3.js"><link rel="prefetch" href="/f2024/assets/js/9.a3806b98.js">
    <link rel="stylesheet" href="/f2024/assets/css/0.styles.0983e6c5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/f2024/" class="home-link router-link-active"><img src="/f2024/mad-d-logo-sm.png" alt="MAD9014" class="logo"> <span class="site-name can-hide">MAD9014</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/f2024/overview/" class="nav-link">
  Overview
</a></div><div class="nav-item"><a href="/f2024/assignments/" class="nav-link">
  Deliverables
</a></div><div class="nav-item"><a href="/f2024/conventions/" class="nav-link">
  Conventions
</a></div><div class="nav-item"><a href="/f2024/resources/" class="nav-link">
  Resources
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/f2024/overview/" class="nav-link">
  Overview
</a></div><div class="nav-item"><a href="/f2024/assignments/" class="nav-link">
  Deliverables
</a></div><div class="nav-item"><a href="/f2024/conventions/" class="nav-link">
  Conventions
</a></div><div class="nav-item"><a href="/f2024/resources/" class="nav-link">
  Resources
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Core JavaScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Browser JavaScript</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/f2024/modules/browser-js/week5/dom-1/" class="sidebar-link">5.1: Document Object Model</a></li><li><a href="/f2024/modules/browser-js/week5/dom-2/" class="sidebar-link">5.2: Document Object Model</a></li><li><a href="/f2024/modules/browser-js/week6/events/" class="sidebar-link">6.1: Handling Events</a></li><li><a href="/f2024/modules/browser-js/week6/forms-events/" class="sidebar-link">6.2: Forms &amp; Events</a></li><li><a href="/f2024/modules/browser-js/week7/project-structure/" class="sidebar-link">7.1: Code Structure &amp; Approaches</a></li><li><a href="/f2024/modules/browser-js/week9/promises/" class="sidebar-link">9.1: Promises</a></li><li><a href="/f2024/modules/browser-js/week9/async/" aria-current="page" class="active sidebar-link">9.2: Asynchronous Programming</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/f2024/modules/browser-js/week9/async/#async-vs-sync" class="sidebar-link">Async vs Sync</a></li><li class="sidebar-sub-header"><a href="/f2024/modules/browser-js/week9/async/#the-javascript-loop" class="sidebar-link">The JavaScript Loop</a></li><li class="sidebar-sub-header"><a href="/f2024/modules/browser-js/week9/async/#tasks-microtasks-ui-render-tasks" class="sidebar-link">Tasks, MicroTasks, UI Render Tasks</a></li><li class="sidebar-sub-header"><a href="/f2024/modules/browser-js/week9/async/#timers" class="sidebar-link">Timers</a></li><li class="sidebar-sub-header"><a href="/f2024/modules/browser-js/week9/async/#async-await" class="sidebar-link">Async - Await</a></li><li class="sidebar-sub-header"><a href="/f2024/modules/browser-js/week9/async/#what-to-do-this-week" class="sidebar-link">What to do this week</a></li></ul></li><li><a href="/f2024/modules/browser-js/week10/ajax/" class="sidebar-link">10.1: AJAX and Fetch</a></li><li><a href="/f2024/modules/browser-js/week10/fetch-apis/" class="sidebar-link">10.2: Fetch and APIs</a></li><li><a href="/f2024/modules/browser-js/week11/fetch-data/" class="sidebar-link">11.1: Dynamic Data</a></li><li><a href="/f2024/modules/browser-js/week11/security/" class="sidebar-link">11.2: Fetch Security</a></li><li><a href="/f2024/modules/browser-js/week12/storage/" class="sidebar-link">12.1: HTML5 APIs</a></li><li><a href="/f2024/modules/browser-js/week12/multi-page/" class="sidebar-link">12.2: Multi-Page, SPA, and JAMStack </a></li><li><a href="/f2024/modules/browser-js/week13/observers/" class="sidebar-link">13.1: Observers &amp; Classes</a></li><li><a href="/f2024/modules/browser-js/week13/destructure/" class="sidebar-link">13.2: Destructuring, Spread, &amp; Enumeration</a></li><li><a href="/f2024/modules/browser-js/week14/project-2/" class="sidebar-link">14: Final Project</a></li><li><a href="/f2024/modules/browser-js/week15/" class="sidebar-link">15: Final Project</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Hybrid Content</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><header><div class="section-title blue">
    Programming with APIs
  </div> <h1>9.2 Asynchronous Code</h1></header> <h2 id="async-vs-sync"><a href="#async-vs-sync" class="header-anchor">#</a> Async vs Sync</h2> <p>Almost all the code that we have written to this point has been synchronous code. That means that you write the code in the order that you expect it to run. The first line of code inside your function
will run and complete before the second line of code.</p> <p>However, there is also Asynchronous code in JavaScript. <code>Promises</code> are an example of this.</p> <p>When you write code that will take an unknown amount of time to complete but you don't want your App to freeze and do nothing until that one task is complete, then you need to use Async tasks.</p> <p>JavaScript has a mechanism known as the event loop. When you pass a list of commands to the event loop, it will keep running each of those commands in order until it gets to the end of your list. This
list is known as the main stack. JavaScript keeps trying to run commands as long as there is something on the main stack.</p> <p>However, sometimes there is a command that would stop the event loop from getting to the next command. It gets blocked from going to the next command in the stack. These types of commands are things
that take a long time to complete, like talking to a database, or the file system, or a network request for a file, or a timer that needs to wait before running.</p> <p>There are specific tasks that are going to take too long and they get put into a secondary area so they can wait for their result. These tasks are known as asynchronous.</p> <p>If the code stays on the main stack and insists on being run before the event loop moves on to the next item then it is called synchronous.</p> <div title="async vs sync" class="video-player"><iframe width="560" height="315" src="https://www.youtube.com/embed/Q-Zmc0E0GYY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="allowfullscreen"></iframe></div> <h2 id="the-javascript-loop"><a href="#the-javascript-loop" class="header-anchor">#</a> The JavaScript Loop</h2> <p>The JavaScript engines, like Chrome's V8, use a single thread to process all your code. It builds a stack of commands to run, in the order that you have written them. As long as each command belongs
to the CORE JavaScript then it gets added to the main run stack.</p> <p>When something that belongs to the Web APIs is encountered it gets added to a secondary list of tasks. Each time the main stack is finished then the JavaScript engine turns it attention to the
secondary list of tasks and will try to run those.</p> <p>The video below does a great job explaining all the parts of this process. It is about 25 minutes so give yourself some time to watch it.</p> <p>You don't need this information to do any of the assignments this semester. However, it will help you to avoid errors in your code and to better understand how your code will be interpreted by the
JavaScript engine. This will lead to you writing much better code in the long run.</p> <div title="Everything you need to know about the JavaScript Loop" class="video-player"><iframe width="560" height="315" src="https://www.youtube.com/embed/8aGhZQkoFbQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="allowfullscreen"></iframe></div> <p>And more about the event loop, asynchronous features, timers, tasks, and microtasks...</p> <div title="Jake Archibald: In The Loop - setTimeout, micro tasks, requestAnimationFrame, requestIdleCallback" class="video-player"><iframe width="560" height="315" src="https://www.youtube.com/embed/cCOL7MC4Pl0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="allowfullscreen"></iframe></div> <h2 id="tasks-microtasks-ui-render-tasks"><a href="#tasks-microtasks-ui-render-tasks" class="header-anchor">#</a> Tasks, MicroTasks, UI Render Tasks</h2> <p>Just as was explained in the Jake Archibald video <a href="https://www.youtube.com/?v=cCOL7MC4Pl0" target="_blank" rel="noopener noreferrer"><code>In the Loop</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, there are different types of tasks that happen at different points on the event loop.
Understanding this sequence will help you to avoid and solve strange errors in your code.</p> <div title="Understanding the order of tasks and microtasks" class="video-player"><iframe width="560" height="315" src="https://www.youtube.com/embed/w-jULX0D5cg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="allowfullscreen"></iframe></div> <p>The main stack is all the code that runs on the event loop. JavaScript wants to run all the commands in the main execution context before it does anything with the tasks or microtasks.</p> <p>The UI render tasks are the one exception to leaving the event loop. The browser can decide to exit the loop and run updates (calculate and paint) for the UI. UI render tasks are mainly automatic
things like updating the interface based on a CSS transition or animation. However, you can create code that runs during this phase with <code>requestAnimationFrame()</code>.</p> <div title="request animation frame" class="video-player"><iframe width="560" height="315" src="https://www.youtube.com/embed/zBRqnSiq_VM" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="allowfullscreen"></iframe></div> <p>If you create a <code>task</code> and inside that task you create another <code>task</code>, the second one will not run until the first task is completed and the event loop has looped around again.</p> <p>If you create a <code>microtask</code> and inside that you create another <code>microtask</code>, then the browser will also run the subsequent microtask(s) before returning to the event loop.</p> <h2 id="timers"><a href="#timers" class="header-anchor">#</a> Timers</h2> <p>In JavaScript we can set timers to call a function at some point in the future.</p> <p>We use the <code>setTimeout()</code> or <code>setInterval</code> functions and pass them a callback function plus a minimum time delay to use (written in milliseconds). We say minimum time delay because the main stack
could still have code in it that is being run. The function from the timeout has to wait for that other code to finish before it can be called.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'f1 is running'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">f2</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Hello </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">. f2 is running.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span>f1<span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span>f2<span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">,</span> <span class="token string">'Dean'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Dean gets passed to f2 as the argument</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="timeouts"><a href="#timeouts" class="header-anchor">#</a> Timeouts</h3> <p>When you want to run a function after a specific time delay then setTimeout is the built-in function to accomplish this.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">setTimeout</span><span class="token punctuation">(</span>myFunc<span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//call the function myFunc after at least 3000ms</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'hi'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2500</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//run the anonymous function after 2500ms</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token string">'myFunc()'</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//call the function myFunc after 1 second</span>

window<span class="token punctuation">.</span><span class="token function">setTimeout</span><span class="token punctuation">(</span>myFunc<span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//same as first example</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="intervals"><a href="#intervals" class="header-anchor">#</a> Intervals</h3> <p>When you want to run something repeatedly after a set time, for example, once every ten seconds, then setInterval is the function to call.</p> <p>Timers running on intervals can be stopped if you call the clearInterval( ) method. Just make sure that you keep a reference to the interval.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> intervalId <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span> myFunc<span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//keep calling myFunc every 3 seconds</span>
<span class="token operator">...</span><span class="token punctuation">.</span>
<span class="token comment">//use the intervalId to stop the interval calls running</span>
<span class="token function">clearInterval</span><span class="token punctuation">(</span> intervalId <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="recursive-timeouts"><a href="#recursive-timeouts" class="header-anchor">#</a> Recursive Timeouts</h3> <p>Another way to approach timed intervals is with a recursive call to the setTimeout function. Inside the function that runs following your setTimeout, you make another call to the same function. The
process repeats itself.</p> <p>The difference with the recursive calls is that it allows us to change the amount of time between the calls or stop it after any call.</p> <p>We can use this method to create ever shorter time spans between callbacks or random times between callbacks.</p> <iframe src="//codepen.io/mad-d/embed/xEAwkw/?height=456&amp;theme-id=0&amp;default-tab=js,result&amp;embed-version=2" width="300" height="456" allowfullscreen="allowfullscreen" style="width:100%;">See the Pen <a href="http://codepen.io/mad-d/pen/xEAwkw/">JavaScript Recursive Timeouts</a> by Mobile Application Design-Development (<a href="http://codepen.io/mad-d">@mad-d</a>) on <a href="http://codepen.io">CodePen</a>.</iframe> <div title="setTimeout and setInterval" class="video-player"><iframe width="560" height="315" src="https://www.youtube.com/embed/0VVJSvlUgtg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="allowfullscreen"></iframe></div> <h2 id="async-await"><a href="#async-await" class="header-anchor">#</a> Async - Await</h2> <p>One of the features added in ES6 was <code>async</code> and <code>await</code>. The combination of these keywords lets us use asynchronous features like <code>fetch</code> inside a function but write the code in a synchronous style.</p> <p>Start by making a function into an <code>async</code> one.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//give a function the ability to pause and wait for a promise</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//this function declaration can now pause and wait for a promise to complete</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> <span class="token function-variable function">f2</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//this function expression can pause and wait for a promise to complete</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> <span class="token function-variable function">res</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">//this arrow function can also pause and wait</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>Then you can use the <code>await</code> keyword as many times as you want. Each one is capable of pausing the function to wait for an async result from a promise.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//make a function that can be called to create a delay</span>
<span class="token keyword">function</span> <span class="token function">delay</span><span class="token punctuation">(</span><span class="token parameter">len</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//call the resolve method after `len` milliseconds have passed</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//function ready to be paused</span>
<span class="token keyword">let</span> <span class="token function-variable function">res</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">//this first call will run 1 second in the future</span>
  <span class="token keyword">let</span> isReady <span class="token operator">=</span> <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>isReady<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// `pending Promise` at this point. Not resolved yet.</span>

  <span class="token comment">//try again with await</span>
  <span class="token comment">//now pause the function and wait for a result</span>
  <span class="token keyword">let</span> isReadyNow <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//function actually pauses to wait for the result from delay()</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>isReadyNow<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//`true`</span>
  <span class="token comment">//isReadyNow actually has a value this time because of await.</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>Starting next week, we will be making calls to remote APIs and retrieving dynamic data. At that point we can use <code>async await</code> to pause a function and wait for the result if we want.</p> <div title="Intro to async and await" class="video-player"><iframe width="560" height="315" src="https://www.youtube.com/embed/BTDeq5HC5bU" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="allowfullscreen"></iframe></div> <div title="Combining async and await with Promises" class="video-player"><iframe width="560" height="315" src="https://www.youtube.com/embed/lGJbPSI-12E" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="allowfullscreen"></iframe></div> <div title="JS interview async question" class="video-player"><iframe width="560" height="315" src="https://www.youtube.com/embed/j1ykOrC2f0A" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="allowfullscreen"></iframe></div> <h2 id="what-to-do-this-week"><a href="#what-to-do-this-week" class="header-anchor">#</a> What to do this week</h2> <div class="custom-block warning"><p class="custom-block-title">TODO Things to do before next week.</p> <ul><li>Read all the content from <code>Modules 9.1, 9.2, and 10.1</code>.</li> <li>Finish working on the Hybrid Quizzes</li></ul></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">9/6/2024, 7:43:10 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/f2024/modules/browser-js/week9/promises/" class="prev">
        9.1: Promises
      </a></span> <span class="next"><a href="/f2024/modules/browser-js/week10/ajax/">
        10.1: AJAX and Fetch
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/f2024/assets/js/app.1fe26343.js" defer></script><script src="/f2024/assets/js/2.309c8f6c.js" defer></script><script src="/f2024/assets/js/36.da367d38.js" defer></script><script src="/f2024/assets/js/4.1db6dd32.js" defer></script><script src="/f2024/assets/js/6.42129677.js" defer></script>
  </body>
</html>
